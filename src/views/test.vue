<template>
  <div class="login-container">
    <el-button @click="daochu">导出</el-button>
    <el-table :data="table" border fit highlight-current-row>
      <el-table-column align="center" label="#" width="95">
        <template slot-scope="scope">
          {{ scope.$index+1 }}
        </template>
      </el-table-column>
      <el-table-column align="center" label="编号" prop="index" />
      <el-table-column align="center" label="时间" prop="time" />
      <el-table-column align="center" label="1号球" prop="one" />
      <el-table-column align="center" label="2号球" prop="two" />
      <el-table-column align="center" label="3号球" prop="third" />
      <el-table-column align="center" label="4号球" prop="four" />
      <el-table-column align="center" label="5号球" prop="five" />
      <el-table-column align="center" label="前区总数" prop="onetofive" />
      <el-table-column align="center" label="6号球" prop="six" />
      <el-table-column align="center" label="7号球" prop="seven" />
      <el-table-column align="center" label="后区总数" prop="sixtosn" />
    </el-table>
  </div>
</template>

<script>
  export default {
    name: 'Login',
    data() {
      return {
        table: []
      }
    },

    mounted() {
      var value = `
23027   2023-03-13  09  10  12  15  23  03  06
23026   2023-03-11  02  13  24  27  30  01  06
23025   2023-03-08  03  09  27  30  31  11  12
23024   2023-03-06  11  15  24  27  30  01  10
23023   2023-03-04  09  21  23  25  33  03  10
23022   2023-03-01  07  11  15  26  28  08  10
23021   2023-02-27  02  09  18  23  27  03  05
23020   2023-02-25  05  06  23  25  28  06  09
23019   2023-02-22  05  08  09  11  15  06  08
23018   2023-02-20  04  08  17  26  30  03  11
23017   2023-02-18  02  05  09  22  27  10  11
23016   2023-02-15  02  04  12  31  32  07  11
23015   2023-02-13  08  16  24  25  34  08  12
23014   2023-02-11  03  08  18  22  24  01  09
23013   2023-02-08  01  02  09  23  25  02  06  
23012   2023-02-06  07  16  17  18  28  02  03
23011   2023-02-04  02  07  08  17  25  01  03
23010   2023-02-01  05  06  13  23  26  01  06
23009   2023-01-30  01  05  11  15  33  01  10
23008   2023-01-18  04  09  17  22  25  01  05
23007   2023-01-16  02  03  24  30  32  01  06
23006   2023-01-14  02  04  12  27  35  06  07
23005   2023-01-11  01  03  10  20  29  06  11
23004   2023-01-09  04  13  15  20  22  04  08
23003   2023-01-07  05  06  14  21  22  02  09
23002   2023-01-04  11  14  21  26  27  02  07
23001   2023-01-02  18  19  24  27  34  11  12
22150   2022-12-31  06  07  26  29  30  03  12
22149   2022-12-28  15  19  22  26  28  02  07
22148   2022-12-26  04  05  06  26  27  07  12
22147   2022-12-24  04  12  22  28  30  09  11
22146   2022-12-21  01  21  23  28  35  07  09
22145   2022-12-19  10  20  29  30  35  06  09
22144   2022-12-17  03  04  08  15  21  04  07
22143   2022-12-14  10  13  14  27  33  07  08
22142   2022-12-12  07  12  14  29  35  01  11
22141   2022-12-10  05  06  14  24  25  02  04
22140   2022-12-07  05  15  25  26  29  04  12
22139   2022-12-05  01  13  14  22  35  02  05
22138   2022-12-03  05  13  16  27  33  07  12
22137   2022-11-30  05  06  08  15  20  07  08
22136   2022-11-28  01  11  15  17  33  03  11
22135   2022-11-26  09  10  27  31  32  01  03
22134   2022-11-23  03  16  23  27  32  03  06
22133   2022-11-21  01  02  14  30  31  06  09
22132   2022-11-19  02  27  30  34  35  09  12
22131   2022-11-16  02  06  08  10  17  05  06
22130   2022-11-14  05  07  15  18  23  05  10
22129   2022-11-12  10  17  23  34  35  01  04
22128   2022-11-09  10  19  21  23  35  04  10
22127   2022-11-07  02  03  08  09  20  04  10
22126   2022-11-05  04  05  08  22  35  01  03  
22125   2022-11-02  03  07  14  16  19  01  11
22124   2022-10-31  02  04  11  25  30  06  12  
22123   2022-10-29  02  20  28  29  30  07  10  
22122   2022-10-26  04  15  17  19  25  06  12
22121   2022-10-24  04  15  16  20  21  04  05  
22120   2022-10-22  11  22  26  30  33  03  05
22119   2022-10-19  01  09  16  25  29  04  09
22118   2022-10-17  02  05  15  17  26  02  08  
22117   2022-10-15  09  12  15  21  32  02  07
22116   2022-10-12  01  07  20  22  31  07  12
22115   2022-10-10  17  19  20  23  27  03  08
22114   2022-10-08  11  21  24  27  28  05  10
22113   2022-10-05  13  15  22  31  33  05  12
22112   2022-09-28  04  11  18  20  26  06  12
22111   2022-09-26  06  12  16  19  31  06  10
22110   2022-09-24  02  13  16  18  23  03  06
22109   2022-09-21  05  09  24  29  35  05  12  
22108   2022-09-19  04  07  13  26  28  07  11  
22107   2022-09-17  07  09  19  28  29  08  10  
22106   2022-09-14  16  17  21  28  32  04  07  
22105   2022-09-12  01  08  09  21  22  01  04  
22104   2022-09-10  03  05  13  19  25  02  05  
22103   2022-09-07  08  12  16  21  32  01  12  
22102   2022-09-05  01  05  14  20  30  02  04  
22101   2022-09-03  02  04  06  07  08  03  06  
22100   2022-08-31  10  19  20  23  31  03  07  
22099   2022-08-29  07  18  25  27  33  04  05
22098   2022-08-27  01  03  06  11  13  03  11  
22097   2022-08-24  05  13  22  28  29  05  11  
22096   2022-08-22  16  19  24  27  33  01  06  
22095   2022-08-20  05  08  22  25  35  02  07  
22094   2022-08-17  03  04  07  12  19  02  05  
22093   2022-08-15  07  11  14  21  29  07  10  
22092   2022-08-13  01  04  12  23  29  05  12  
22091   2022-08-10  02  11  20  22  34  04  12  
22090   2022-08-08  01  20  24  25  31  09  12  
22089   2022-08-06  01  20  21  31  33  03  11  
22088   2022-08-03  01  08  10  20  35  06  11  
22087   2022-08-01  04  06  10  24  28  06  12
22086   2022-07-30  04  10  21  28  31  08  11  
22085   2022-07-27  11  16  31  33  35  06  08  
22084   2022-07-25  03  11  19  25  27  04  12  
22083   2022-07-23  02  09  17  26  32  04  06  
22082   2022-07-20  04  26  27  30  33  02  09  
22081   2022-07-18  05  10  19  31  32  09  10  
22080   2022-07-16  10  17  30  31  34  03  06  
22079   2022-07-13  07  10  19  26  32  08  12      
22078   2022-07-11  02  03  18  20  27  01  02  
22077   2022-07-09  05  10  11  16  19  01  10      
22076   2022-07-06  05  17  30  34  35  02  09  
22075   2022-07-04  04  12  13  17  18  07  09  
22074   2022-07-02  02  06  21  25  28  02  06  
22073   2022-06-29  11  18  21  25  32  02  04
22072   2022-06-27  01  12  13  15  30  03  07      
22071   2022-06-25  09  15  19  25  29  08  09  
22070   2022-06-22  01  07  17  23  35  07  11  
22069   2022-06-20  02  03  23  28  35  02  09  
22068   2022-06-18  03  06  10  15  23  03  08  
22067   2022-06-15  04  14  15  32  33  10  11  
22066   2022-06-13  02  24  25  26  34  03  12
22065   2022-06-11  05  10  13  22  28  01  04  
22064   2022-06-08  02  19  22  25  35  05  07
22063   2022-06-06  02  03  22  26  31  06  10  
22062   2022-06-04  05  09  11  12  31  07  11  
22061   2022-06-01  06  09  19  22  30  01  06
22060   2022-05-30  02  06  10  11  20  03  09  
22059   2022-05-28  04  15  18  32  34  04  09
22058   2022-05-25  03  04  24  26  35  07  08
22057   2022-05-23  06  12  18  21  35  07  10  
22056   2022-05-21  02  11  15  17  31  07  09  
22055   2022-05-18  01  02  12  15  23  04  06
22054   2022-05-16  05  16  21  23  34  07  10
22053   2022-05-14  09  17  19  20  25  01  09
22052   2022-05-11  01  13  18  29  35  04  09
22051   2022-05-09  01  16  17  19  33  05  06
22050   2022-05-07  02  10  21  24  30  08  10  
22049   2022-05-04  06  10  20  28  35  01  10  
22048   2022-05-02  16  22  28  29  32  08  09  
22047   2022-04-30  07  10  11  12  33  03  11  
22046   2022-04-27  06  07  12  22  27  03  05
22045   2022-04-25  02  03  07  12  20  01  05  
22044   2022-04-23  01  02  16  17  20  03  07  
22043   2022-04-20  02  16  17  24  30  09  12  
22042   2022-04-18  08  10  11  29  32  02  06  
22041   2022-04-16  05  15  25  26  33  06  11  
22040   2022-04-13  10  19  25  29  33  08  12
22039   2022-04-11  01  08  11  22  31  05  11  
22038   2022-04-09  07  09  11  12  26  09  12  
22037   2022-04-06  01  09  17  20  28  06  10  
22036   2022-04-04  18  19  21  26  34  06  07  
22035   2022-04-02  09  11  13  23  31  05  08  
22034   2022-03-30  02  10  24  27  28  06  07  
22033   2022-03-28  08  15  16  19  33  03  04
22032   2022-03-26  05  09  18  31  32  01  05
22031   2022-03-23  07  14  16  20  28  04  08  
22030   2022-03-21  12  14  15  21  30  01  09  
22029   2022-03-19  07  08  10  14  17  10  12  
22028   2022-03-16  04  09  16  17  35  01  07
22027   2022-03-14  03  06  11  31  32  05  12
22026   2022-03-12  11  14  22  23  27  08  10  
22025   2022-03-09  04  07  22  24  29  01  07  
22024   2022-03-07  01  02  11  30  35  01  12  
22023   2022-03-05  04  05  18  20  25  11  12
22022   2022-03-02  01  05  14  17  28  06  07
22021   2022-02-28  11  15  16  18  35  06  09
22020   2022-02-26  16  17  30  31  35  08  09
22019   2022-02-23  01  04  07  17  21  01  02
22018   2022-02-21  16  21  29  31  34  06  09
22017   2022-02-19  10  14  18  23  25  07  11
22016   2022-02-16  01  07  17  26  32  01  09
22015   2022-02-14  01  02  08  12  30  05  12
22014   2022-02-12  01  04  10  18  32  01  09
22013   2022-02-09  04  09  16  25  32  05  06
22012   2022-01-26  03  05  10  33  34  07  10
22011   2022-01-24  03  05  17  24  32  05  12
22010   2022-01-22  04  19  25  31  35  02  11
22009   2022-01-19  13  14  18  31  33  07  10
22008   2022-01-17  01  02  13  18  34  06  07
22007   2022-01-15  05  22  23  25  35  03  11
22006   2022-01-12  01  05  07  17  20  05  12
22005   2022-01-10  02  13  17  19  34  05  09
22004   2022-01-08  07  20  27  30  33  03  04
22003   2022-01-05  02  18  24  25  34  08  12
22002   2022-01-03  04  06  07  09  24  04  12
22001   2022-01-01  08  11  19  22  29  03  11
21150   2021-12-29  04  10  11  23  26  07  10
21149   2021-12-27  20  26  28  30  35  10  11
21148   2021-12-25  01  04  12  16  29  04  08
21147   2021-12-22  01  02  08  12  26  01  07
21146   2021-12-20  03  05  08  18  20  09  11
21145   2021-12-18  03  08  25  29  30  01  06
21144   2021-12-15  03  20  25  30  34  02  09
21143   2021-12-13  09  17  19  29  34  04  11
21142   2021-12-11  11  13  17  19  25  02  09
21141   2021-12-08  02  08  16  29  34  05  12
21140   2021-12-06  05  24  26  33  35  09  12
21139   2021-12-04  05  13  18  23  34  08  09
21138   2021-12-01  09  11  12  15  31  05  11
21137   2021-11-29  02  07  13  14  19  04  05
21136   2021-11-27  08  12  19  27  33  02  05
21135   2021-11-24  04  07  17  29  31  05  06
21134   2021-11-22  02  06  14  19  28  01  06
21133   2021-11-20  08  09  17  26  28  06  08
21132   2021-11-17  04  21  28  29  33  03  11
21131   2021-11-15  06  08  16  34  35  05  06
21130   2021-11-13  02  03  14  27  28  05  10
21129   2021-11-10  02  16  17  18  34  04  10
21128   2021-11-08  14  17  18  23  27  05  08
21127   2021-11-06  01  02  15  17  26  02  11
21126   2021-11-03  01  11  12  34  35  09  12
21125   2021-11-01  17  19  21  27  31  04  09
21124   2021-10-30  10  17  22  25  35  07  09
21123   2021-10-27  08  23  26  27  33  08  09
21122   2021-10-25  14  15  26  27  29  04  05
21121   2021-10-23  02  15  19  29  30  02  09
21120   2021-10-20  05  10  21  25  31  05  11
21119   2021-10-18  01  02  09  16  30  09  10
21118   2021-10-16  14  17  18  28  34  02  03
21117   2021-10-13  11  18  21  22  33  05  06
21116   2021-10-11  04  25  28  29  35  03  11
21115   2021-10-09  08  13  19  20  29  06  10
21114   2021-10-06  08  09  13  29  30  01  11
21113   2021-09-29  17  18  25  27  28  04  08
21112   2021-09-27  18  21  22  23  35  11  12
21111   2021-09-25  07  08  15  19  28  08  09
21110   2021-09-22  11  14  29  31  32  11  12
21109   2021-09-20  03  04  07  27  31  06  09
21108   2021-09-18  05  19  22  26  35  02  06
21107   2021-09-15  03  05  13  20  25  07  11
21106   2021-09-13  02  13  14  32  34  02  12
21105   2021-09-11  07  10  11  17  18  04  09
21104   2021-09-08  23  25  26  30  33  03  11
21103   2021-09-06  04  10  23  30  31  05  11
21102   2021-09-04  02  08  11  16  23  02  07
21101   2021-09-01  13  18  19  27  32  06  11
21100   2021-08-30  07  11  23  26  28  02  07
21099   2021-08-28  15  19  27  28  30  03  04
21098   2021-08-25  02  07  21  27  33  07  09
21097   2021-08-23  11  26  30  31  33  03  10
21096   2021-08-21  07  08  10  20  21  01  05
21095   2021-08-18  10  15  19  20  30  11  12
21094   2021-08-16  05  06  24  27  33  05  12
21093   2021-08-14  20  25  27  28  31  08  11
21092   2021-08-11  12  14  27  28  34  03  07
21091   2021-08-09  01  04  10  21  29  03  05
21090   2021-08-07  06  07  19  26  32  06  12
21089   2021-08-04  01  17  24  28  35  10  12
21088   2021-08-02  02  14  31  34  35  01  07
21087   2021-07-31  10  14  15  25  28  03  10
21086   2021-07-28  02  03  07  16  17  06  10
21085   2021-07-26  01  12  15  26  35  10  11
21084   2021-07-24  02  10  14  30  33  06  09
21083   2021-07-21  07  09  11  26  35  01  08
21082   2021-07-19  01  14  22  29  33  03  10
21081   2021-07-17  05  13  24  29  35  07  08
21080   2021-07-14  15  16  20  29  30  06  10
21079   2021-07-12  06  14  19  26  33  08  11
21078   2021-07-10  02  08  17  19  25  01  05
21077   2021-07-07  02  06  09  21  25  06  08
21076   2021-07-05  06  13  22  25  26  02  04
21075   2021-07-03  06  14  15  17  20  01  05  
21074   2021-06-30  11  14  18  20  25  03  07
21073   2021-06-28  08  12  14  20  24  06  10
21072   2021-06-26  02  03  15  22  26  03  11
21071   2021-06-23  08  11  16  29  35  01  04
21070   2021-06-21  03  20  21  22  24  06  12
21069   2021-06-19  01  03  24  32  33  04  06
21068   2021-06-16  02  20  21  26  30  02  10
21067   2021-06-14  01  04  22  23  34  08  09
21066   2021-06-12  24  26  29  34  35  09  11
21065   2021-06-09  23  25  30  31  35  07  08
21064   2021-06-07  01  17  19  32  34  06  10
21063   2021-06-05  05  09  14  29  30  09  11
21062   2021-06-02  04  06  23  32  34  05  07
21061   2021-05-31  15  19  20  26  32  04  07
21060   2021-05-29  09  13  25  31  33  03  07
21059   2021-05-26  04  16  27  28  35  02  09
21058   2021-05-24  13  15  17  23  34  01  11
21057   2021-05-22  05  07  19  20  28  05  07
21056   2021-05-19  03  11  16  21  26  09  10
21055   2021-05-17  03  06  10  11  24  10  11
21054   2021-05-15  03  06  17  20  25  03  09
21053   2021-05-12  03  06  15  17  35  07  11
21052   2021-05-10  02  11  13  14  30  09  12
21051   2021-05-08  01  04  14  16  19  03  04
21050   2021-05-05  09  22  32  33  35  05  10
21049   2021-05-03  01  10  22  23  25  02  12
21048   2021-05-01  04  07  17  21  27  10  12
21047   2021-04-28  01  06  09  25  33  04  08
21046   2021-04-26  06  08  12  14  18  06  08
21045   2021-04-24  01  04  06  11  19  07  09
21044   2021-04-21  06  18  31  33  35  10  11
21043   2021-04-19  07  12  17  19  34  01  10
21042   2021-04-17  09  15  20  23  29  04  05
21041   2021-04-14  02  05  09  11  32  04  09
21040   2021-04-12  02  03  09  16  19  03  07
21039   2021-04-10  04  12  14  21  35  02  11
21038   2021-04-07  09  11  20  29  32  01  07
21037   2021-04-05  10  21  27  29  33  04  12
21036   2021-04-03  08  17  25  28  33  07  11
21035   2021-03-31  05  11  16  30  32  03  04
21034   2021-03-29  08  10  14  25  34  07  08
21033   2021-03-27  01  03  05  30  32  01  05
21032   2021-03-24  01  11  14  34  35  07  10
21031   2021-03-22  01  04  19  20  34  03  05
21030   2021-03-20  18  23  25  26  32  02  07
21029   2021-03-17  02  06  10  32  33  04  07
21028   2021-03-15  02  03  05  17  29  04  10
`
      let code = value.split(/[(\r\n)\r\n]+/); // 根据换行或者回车进行识别
      code.forEach((item, index) => { // 删除空项
        if (!item) {
          code.splice(index, 1);
        }
      })
      let newFuu = []
      code.forEach(e => {
        newFuu.push({
          index: e.substring(0, 5),
          time: e.substring(8, 18),
          one: parseInt(e.substring(20, 22)),
          two: parseInt(e.substring(24, 26)),
          third: parseInt(e.substring(28, 30)),
          four: parseInt(e.substring(32, 34)),
          five: parseInt(e.substring(36, 38)),
          six: parseInt(e.substring(40, 42)),
          seven: parseInt(e.substring(44, 46)),
          sixtosn: parseInt(e.substring(40, 42)) + parseInt(e.substring(44, 46)),
          onetofive: parseInt(e.substring(20, 22)) + parseInt(e.substring(24, 26)) + parseInt(e.substring(28,
            30)) + parseInt(e.substring(32, 34)) + parseInt(e.substring(36, 38)) + parseInt(e.substring(40,
            42)) + parseInt(e.substring(44, 46))
        })
      })



      console.log(newFuu);
      let oneSum = 0
      let twoSum = 0
      let thirdSum = 0
      let fourSum = 0
      let fiveSum = 0
      let sixSum = 0
      let sevenSum = 0
      let oneToFiveSum = 0
      let sxtosn = 0
      newFuu.forEach(e => {
        oneSum += e.one
        twoSum += e.two
        thirdSum += e.third
        fourSum += e.four
        fiveSum += e.five
        sixSum += e.six
        sevenSum += e.seven
        oneToFiveSum += e.one + e.two + e.third + e.four + e.five
        sxtosn += e.six + e.seven
      })
      console.log('一号球总数', oneSum)
      console.log('一号球平均数', oneSum / newFuu.length)
      console.log('二号球总数', twoSum)
      console.log('二号球平均数', twoSum / newFuu.length)
      console.log('三号球总数', thirdSum)
      console.log('三号球平均数', thirdSum / newFuu.length)
      console.log('四号球总数', fourSum)
      console.log('四号球平均数', fourSum / newFuu.length)
      console.log('五号球总数', fiveSum)
      console.log('五号球平均数', fiveSum / newFuu.length)
      console.log('六号球总数', sixSum)
      console.log('六号球平均数', sixSum / newFuu.length)
      console.log('七号球总数', sevenSum)
      console.log('七号球平均数', sevenSum / newFuu.length)
      console.log('七号球总数', sevenSum)
      console.log('七号球平均数', sevenSum / newFuu.length)
      console.log("一号到五号球总数", oneToFiveSum)
      console.log("一号到五号球平均数", oneToFiveSum / newFuu.length)
      console.log("6号球到7号球总数", sxtosn)
      console.log("6号球到7号球平均数", sxtosn / newFuu.length)

      this.table = newFuu
    },
    methods: {
      daochu() {


        import('@/vendor/Export2Excel').then(excel => {
          const tHeader = ['时间', '1号球', '2号球', '3号球', '4号球', '5号球', '前区总数', '6号球', '7号球', '后区总数'] // 表头名称
          const filterVal = ['time', 'one', 'two', 'third', 'four', 'five', 'onetofive', 'six', 'seven', 'sixtosn']
          const list = this.table
          const data = this.formatJson(filterVal, list)
          excel.export_json_to_excel({
            header: tHeader,
            data,
            filename: '体彩数据',
            autoWidth: true,
            bookType: 'xlsx'
          })
        })
      },
      formatJson(filterVal, jsonData) {
        return jsonData.map(v => filterVal.map(j => {
          return v[j]
        }))
      },
    }
  }

</script>

<style lang="scss" scoped>


</style>
